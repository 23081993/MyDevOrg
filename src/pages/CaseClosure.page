<apex:page standardController="Case" extensions="CaseClosureController" standardStylesheets="false" showHeader="false" sidebar="false" applyHtmlTag="false" id="idPage"  >
    <apex:stylesheet value="{!URLFOR($Resource.SLDS221, 'assets/styles/salesforce-lightning-design-system.min.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.SLDS221, 'assets/styles/salesforce-lightning-design-system.css')}" />
    <script >
       function validateForm(){
             document.getElementById("idOutcomeError").innerHTML ='';
             document.getElementById("idDetailError").innerHTML='';
             document.getElementById("idActionError").innerHTML='';
             document.getElementById("idSentimentError").innerHTML='';
             var isValidForm = true;
             var errorMessages = '';
             var type='{!caseObj.type}';
          
             if (document.getElementById("idPage:idForm:idSentiment").value == '') {
                 document.getElementById("idSentimentError").innerHTML = "Error: You must enter a value.";
                 isValidForm = false;
             }
             else if (document.getElementById("idPage:idForm:idOutcome").value == '') {
                 document.getElementById("idOutcomeError").innerHTML = "Error: You must enter a value.";
                 isValidForm = false;
             }

             else if (document.getElementById("idPage:idForm:idDetail").value == '') {
                document.getElementById("idDetailError").innerHTML = "Error: You must enter a value.";
                isValidForm = false;
             }     

           
             else if (document.getElementById("idPage:idForm:idAction").value == '') {
                document.getElementById("idActionError").innerHTML = "Error: You must enter a value.";
                isValidForm = false;
            } 
            else if (document.getElementById("idPage:idForm:idDepartment").value == '') {
                document.getElementById("idDepartmentError").innerHTML = "Error: You must enter a value.";
                isValidForm = false;
            } 
           
           /* Commented Due to CRM-6508 - Serious complaint field not needed *******
            else if (type=='Complaint' && document.getElementById("idPage:idForm:idComplaint").value == '' ){
               document.getElementById("idActionComplaint").innerHTML = "Error: You must enter a value.";
                isValidForm = false;
            }
            ********************************************************************/
           if (isValidForm == true){
               saveRecord();
           }
       }
       function reloadParent(){
           setTimeout(function(){ window.parent.location ='{!'/lightning/r/Case/'+ caseObj.Id + '/view'}'}, 2000);                 
       }        
    </script>
    <style>
        .tooltip {
            position: relative;
            display: inline-block;
         }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: DarkSlateGray ;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            top: -5px;
            left: 110%;
        }
        
        .tooltip .tooltiptext::after {
            position: absolute;
            top: 50%;
            right: 100%;
            margin-top: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: transparent black transparent transparent;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
         }
    </style>
   
  <apex:form id="idForm" > 
          <apex:actionFunction action="{!saveRecord}" name="saveRecord"  oncomplete="reloadParent();"/>
          <div class="slds" > 
          

          <div class="slds-form--stacked slds-m-top--small " >
                  
                    <br/>
                    <div class="slds-form-element__control">
                          <div >Customer Sentiment</div> 
                          <apex:inputField styleClass="slds-input" id="idSentiment"  label="Customer Sentiment" value="{!caseObj.Customer_Sentiment__c}" />
                          <span style="color: red;" id="idSentimentError"></span>
                    </div>  
                    <br/>
              
                    <div class="slds-form-element__control ">
                         <div Class="tooltip" >Outcome<span Class="tooltiptext">{!$ObjectType.case.fields.Case_Closure_Outcome__c.inlineHelpText}</span></div> 
                          <apex:inputField id="idOutcome" styleClass="slds-input" value="{!caseObj.Case_Closure_Outcome__c}"/>
                             <span style="color: red;" id="idOutcomeError"></span>
                    </div> 
                    <br/>
              
                    <div class="slds-form-element__control">
                     <div Class="tooltip" >Detail<span Class="tooltiptext">{!$ObjectType.case.fields.Closure_Detail__c.inlineHelpText}</span></div> 
                     <apex:inputField id="idDetail" styleClass="slds-input" value="{!caseObj.Closure_Detail__c}"/>
                          <span style="color: red;" id="idDetailError"></span>
                    </div> 
                    <br/>
                    <div class="slds-form-element__control">
                      <div Class="tooltip" >Action<span Class="tooltiptext">{!$ObjectType.case.fields.Action_to_Customer__c.inlineHelpText}</span></div> 
                      <apex:inputField id="idAction" styleClass="slds-input" value="{!caseObj.Action_to_Customer__c}"/>
                          <span style="color: red;" id="idActionError"></span>
                    </div>
                    <br/>
                    <div class="slds-form-element__control">
                      <div Class="tooltip" >Department<span Class="tooltiptext">{!$ObjectType.case.fields.Department__c.inlineHelpText}</span></div> 
                      <apex:inputField id="idDepartment" styleClass="slds-input" value="{!caseObj.Department__c}"/>
                          <span style="color: red;" id="idDepartmentError"></span>
                    </div>
                    <br/>
                    <!--
                    <div class="slds-grid">
                          <div class="slds-col">
                              <apex:outputPanel rendered="{!If(caseObj.type=='Complaint',true,false)}"  >
                                      <div class="slds-picklist slds-picklist--multi">
                                        <div >Serious Complaint</div>
                                        <apex:inputField id="idComplaint"  styleClass="slds-input"  value="{!caseObj.TMC_Reporting__c}"/>
                                        <span style="color: red;" id="idActionComplaint"></span>
                                     </div>
                               </apex:outputPanel>
                        </div>
					</div>
                   -->
                      
               </div>
              
              <br/>
               <div class="slds-docked-form-footer">
                   
                       <apex:commandButton styleClass="slds-button slds-button--brand" action="{!doReferesh}"  value="Refresh" /> 

                       <button onclick="reloadParent();" class="slds-button slds-button--brand" >Cancel </button>
                      
                       <apex:commandButton styleClass="slds-button slds-button--brand" onclick="return validateForm();" reRender="idForm"   value="Save" /> 
                  
               </div>
          </div>  
     
    
            
  </apex:form>
 
</apex:page>